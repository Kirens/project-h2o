<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
<style>
body{
  margin: 0;
  padding: 0;
}
canvas{
  display: block;
}
div{
  text-align: center;
  width: 100%;
  position: absolute;
}
</style>
</head>
<body>


<div>camera position<input type="range" value="75" min="0" max="100" id="cameraCtrl"></div>

<script src="three.min.js"></script>
<script src="stats.min.js"></script>
<script>

function displaywheel(e){
    var evt=window.event || e //equalize event object
	var delta=evt.detail? evt.detail*(-120) : evt.wheelDelta //check for evt.detail first so Opera uses that instead of evt.wheelDelta
	document.getElementById("wheelvalue").innerHTML=delta //delta returns +120 when wheel is scrolled up, -120 when scrolled down
return true
}

var width  = window.innerWidth,
    height = window.innerHeight,
    clock = new THREE.Clock(),
    cameraTarget = new THREE.Vector3( 0, 10, 0 ),
    renderer,
    camera,
    scene,
    ambientLight,
    helper,
    miku,
    animation,
    stats;

var rotationVal;

stats = new Stats();
stats.domElement.style.position = 'absolute';
stats.domElement.style.top = '0px';
document.body.appendChild( stats.domElement );

renderer = new THREE.WebGLRenderer();
renderer.setSize( width, height );
renderer.shadowMapEnabled = true;
document.body.appendChild( renderer.domElement );

document.querySelector( 'canvas' ).setAttribute("id", "MainRender");

scene = new THREE.Scene();

camera = new THREE.PerspectiveCamera( 40, width / height, 1, 1000 );
camera.position.set(
  50 * Math.sin( 3 / 2 * Math.PI ),
  10,
  50 * Math.cos( 3 / 2 * Math.PI )
);
camera.lookAt( cameraTarget );

ambientLight = new THREE.AmbientLight( 0xcccccc );
scene.add( ambientLight );

var directionalLight = new THREE.DirectionalLight( 0xffffff, 0.5 );
directionalLight.position.set( 0, 1, 0 );
scene.add( directionalLight );

//helper = new THREE.AxisHelper( 10 );
//scene.add( helper );


var loader = new THREE.JSONLoader();
loader.load( 'Hus.js', function( geo, mat ) {
  miku = new THREE.SkinnedMesh(
    geo,
    new THREE.MeshFaceMaterial( mat )
  );

  miku.material.materials.forEach(function ( mat ) {
    //mat.skinning = true;
  } );

  scene.add( miku );

  //THREE.AnimationHandler.add( miku.geometry.animations[ 0 ] );
  //animation = new THREE.Animation(
    //miku,
    //miku.geometry.animations[ 0 ].name,
    //THREE.AnimationHandler.CATMULLROM
  //);
  //animation.play();
  
  ( function renderLoop (){
    requestAnimationFrame( renderLoop );
    stats.update();
    var delta = clock.getDelta();
    var theta = clock.getElapsedTime();
    //animation.update( delta );
    renderer.render( scene, camera );
  } )();
} );

// cameraCtrl
document.querySelector( '#cameraCtrl' ).addEventListener( 'change', function () {
  var val = this.value / 100 * 2 * Math.PI;
    camera.position.set(
      50 * Math.sin( val ),
      10,
      50 * Math.cos( val )
    );
    camera.lookAt( cameraTarget );
} );

function UpdatePosVal(e) {
  var val = e.value / 100 * 2 * Math.PI;
    camera.position.set(
      50 * Math.sin( val ),
      10,
      50 * Math.cos( val )
    );
    camera.lookAt( cameraTarget );
}

</script>

<script type="text/javascript">
 
var myimages=["Hachune_HairTex.jpg","Hachune_HeadTex.jpg","Hachune_BodyTex.jpg"];
 
var slideshow=document.getElementById("MainRender");
var nextslideindex=0;
var scrlindex = 75;
 
function rotateimage(e){
    var evt=window.event || e //equalize event object
    var delta=evt.detail? evt.detail*(-120) : evt.wheelDelta //delta returns +120 when wheel is scrolled up, -120 when scrolled down
    
    scrlindex=(delta<=-120)? scrlindex+5 : scrlindex-5 //move image index forward or back, depending on whether wheel is scrolled down or up
    scrlindex=(scrlindex<0)? 95 : (scrlindex>100)? 5 : scrlindex //wrap image index around when it goes beyond lower and upper boundaries
    
    document.querySelector( '#cameraCtrl' ).value = scrlindex;
    
    nextslideindex=(delta<=-120)? nextslideindex+1 : nextslideindex-1 //move image index forward or back, depending on whether wheel is scrolled down or up
    nextslideindex=(nextslideindex<0)? myimages.length-1 : (nextslideindex>myimages.length-1)? 0 : nextslideindex //wrap image index around when it goes beyond lower and upper boundaries
    slideshow.src=myimages[nextslideindex];
    if (evt.preventDefault) //disable default wheel action of scrolling page
        {
        evt.preventDefault();
        //alert("ih");
        }
    else
        {
        return false;
        alert("hi");
        }
//alert(scrlindex);
UpdatePosVal(document.querySelector( '#cameraCtrl' ));
}
 
var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel" //FF doesn't recognize mousewheel as of FF3.x
 
if (slideshow.attachEvent) //if IE (and Opera depending on user setting)
    slideshow.attachEvent("on"+mousewheelevt, rotateimage)
else if (slideshow.addEventListener) //WC3 browsers
    slideshow.addEventListener(mousewheelevt, rotateimage, false)
 
 
</script>

</body>
</html>